/***
 *  BetterStudio Themes Core.
 *
 *  ______  _____   _____ _                           _____
 *  | ___ \/  ___| |_   _| |                         /  __ \
 *  | |_/ /\ `--.    | | | |__   ___ _ __ ___   ___  | /  \/ ___  _ __ ___
 *  | ___ \ `--. \   | | | '_ \ / _ \ '_ ` _ \ / _ \ | |    / _ \| '__/ _ \
 *  | |_/ //\__/ /   | | | | | |  __/ | | | | |  __/ | \__/\ (_) | | |  __/
 *  \____/ \____/    \_/ |_| |_|\___|_| |_| |_|\___|  \____/\___/|_|  \___|
 *
 *  Copyright Â© 2017 Better Studio
 *
 *
 *  Our portfolio is here: http://themeforest.net/user/Better-Studio/portfolio
 *
 *  \--> BetterStudio, 2017 <--/
 */
!function(e){"use strict";function n(n){if(n="undefined"==typeof n?!0:n,n&&e(window).scroll(),document.createEvent){var t=document.createEvent("Event");t.initEvent("resize",!0,!0),window.dispatchEvent(t)}else{var a=document.documentElement,i=document.createEventObject();a.fireEvent("onresize",i)}}function t(n){return this.prefix="bs_ajax_paginate_",this.deferredPrefix="bs_deferred_loading_",this.isPrevPage=!1,this.$link_el=!1,this.id=!1,this.paginationStyle=!1,this.settings=e.extend({afterSuccessDeferredAjax:function(){}},n),this}var a,i={},s={};t.prototype.init=function(n){var t=this;e(n).on("click",".bs-ajax-pagination a",function(n){n.preventDefault();var i=e(this),s=i.parent();if(i.hasClass("disabled")||s.hasClass("bs-pagination-loading"))return!1;s.addClass("bs-pagination-loading");var r=i.closest(".bs-pagination");t.$link_el=i,t.id=i.data("id");try{if(!t.id)throw"invalid element";t.setNewPageNumber(),t.paginationStyle=t.getPaginationStyle();var o=t.getAjaxProps(),d=r.prevAll(".bs-pagination-wrapper"),l=t.cache_get(o.current_page,t.id);if("object"==typeof l)d.addClass("bs-pagination-cached"),t.handle_response(l),s.removeClass("bs-pagination-loading");else{switch(d.removeClass("bs-pagination-cached"),2==o.current_page&&t.cache_add(1,{output:d.html(),label:r.find(".bs-pagination-label").html(),have_next:!0,have_prev:!1},t.id),t.paginationStyle){case"next_prev":d.children().addClass("bs-pagination-in-loading"),d.prepend(t.getLoadingRawHtml());break;case"more_btn_infinity":i.find(".loaded").hide(),i.find(".loading").show(),i.removeClass("more_btn_infinity").addClass("infinity").addClass("bs-pagination-in-loading"),r.removeClass("more_btn_infinity").addClass("infinity");break;case"infinity":case"more_btn":i.addClass("bs-pagination-in-loading"),i.find(".loaded").hide(),i.find(".loading").show()}a=e.ajax({url:o.ajax_url,type:"POST",dataType:"json",data:o}).fail(function(e){switch(s.removeClass("bs-pagination-loading"),t.paginationStyle){case"more_btn_infinity":case"next_prev":d.find(".bs-pagin-loading-wrapper").remove(),i.addClass("bs-pagination-in-loading");break;case"infinity":case"more_btn":i.addClass("bs-pagination-in-loading"),i.find(".loaded").show(),i.find(".loading").hide()}"abort"!==e.statusText&&alert("cannot load data. please check your internet connection!")}).done(function(e){switch(t.handle_response(e),t.cacheThisStyle(t.paginationStyle)&&t.cache_add(o.current_page,e,t.id),t.paginationStyle){case"more_btn_infinity":i.removeClass("bs-pagination-in-loading"),d.find(".bs-pagin-loading-wrapper").remove();break;case"next_prev":i.removeClass("bs-pagination-in-loading"),d.find(".bs-pagin-loading-wrapper").remove(),d.children().removeClass("bs-pagination-in-loading");break;case"infinity":case"more_btn":i.removeClass("bs-pagination-in-loading"),i.find(".loaded").show(),i.find(".loading").hide()}s.removeClass("bs-pagination-loading")})}}catch(p){t.debug(p)}}),new OnScreen({tolerance:0,debounce:100,container:window}).on("enter",".bs-ajax-pagination.infinity",function(n){e(n).find("a").click()})},t.prototype.filter_slider_params=function(e){return"undefined"!=typeof e.autoplayspeed&&(e.autoplaySpeed=e.autoplayspeed),e.dots="undefined"!=typeof e.sliderControlDots&&"off"!==e.sliderControlDots,e.autoplay="undefined"!=typeof e.sliderAutoplay&&parseInt(e.sliderAutoplay),e.speed=e.sliderAnimationSpeed,"undefined"!=typeof e.sliderControlNextPrev&&"off"==e.sliderControlNextPrev&&(e.appendArrows=!1),e},t.prototype.handler_slider=function(t){var a=this;e.fn.slick&&(e(".bs-slider-items-container",t).each(function(){var n=e(this),t=e(document.body).hasClass("rtl");if(!n.hasClass("slick-ready")){var i=n.data(),s=a.filter_slider_params(e.extend({sliderControlDots:"off",prevArrow:'<a class="btn-bs-pagination prev" rel="prev" title="Previous">\n			<i class="fa fa-caret-'+(t?"right":"left")+'" aria-hidden="true"></i>\n		</a>',nextArrow:'<a rel="next" class="btn-bs-pagination next" title="Next">\n			<i class="fa fa-caret-'+(t?"left":"right")+'" aria-hidden="true"></i>\n		</a>',rtl:e(document.body).hasClass("rtl"),slideMargin:25,slide:".bs-slider-item",appendArrows:n.find(".bs-slider-controls .bs-control-nav"),classPrefix:"bs-slider-",dotsClass:"bs-slider-dots",customPaging:function(n,t){return e('<span class="bts-bs-dots-btn"></span>').text(t+1)}},i));s.sliderControlDots&&i.sliderControlDots&&(s.appendDots=n.find(".bs-slider-controls"),s.dotsClass+=" "+s.dotsClass+"-"+i.sliderControlDots),n.slick(s),n.addClass("slick-ready")}}),e(".multi-tab").on("shown.bs.tab",'a[data-toggle="tab"]:not([data-deferred-init])',function(t){var a=e(t.target).attr("href");e(a).find(".bs-slider-items-container").slick("setPosition"),n()}))},t.prototype.refreshLazyImages=function(){"object"==typeof bsLazy&&bsLazy.revalidate()},t.prototype.bindDeferredEvents=function(t){var a=200,i=this,s=0;e(".multi-tab",t).on("show.bs.tab","a[data-deferred-init]",function(){var n=e(this).closest(".multi-tab").find(".active").attr("href");a=e(n).height()}),e(".tabs-section",t).on("show.bs.tab","a[data-deferred-init]",function(){var n=e(this).closest(".tabs-section").find(".active:visible a").data("target"),t=e(n);a=t.height()}).on("show.bs.tab","a",function(){i.refreshLazyImages();var n=e(this).closest(".tabs-section").find(".active:visible a").data("target"),t=e(n),a=t.outerHeight();if(a){var r=t.closest(".tab-content");if(r.length){var o=Math.max(a,parseInt(r.outerHeight()));o=Math.max(o,s),r.css("min-height",o).data("bs-height",o),s=o}}}),e("a[data-deferred-init]",t).each(function(){var t=e(this),s=t.data("deferred-event")||"click";t.closest(".deferred-block-exclude").length>0||t.on(s,function(){var t=e(this),s=t.data("deferred-init"),r=e("#bsd_"+s),o=r.closest(".bs-deferred-container");if(r.hasClass("bs-deferred-load-wrapper"))if(r.hasClass("bs-deferred-loaded")){var d=r.closest(".bs-pinning-block.pinned").length;n(!d)}else o.removeClass("bs-tab-animated"),i.handleDeferredElements(r,{loadingHeight:a?a:void 0},function(){o.addClass("bs-tab-animated"),r.addClass("bs-deferred-loaded");var e=o.find(".bs-pagination");!a||e.length&&!e.hasClass("next_prev")||o.css("min-height",a),a=void 0})})})},t.prototype.handleDeferredElements=function(t,a,s){var r=this;t.hasClass("bs-deferred-load-wrapper")||(t=t.find(".bs-deferred-load-wrapper")),t.each(function(){var t=e(this);if(!t.hasClass("deferred-html-exists")){if(a=e.extend({loadingHeight:100,loadingMinHeight:0},a),!t.find(".deferred-loading-container").length){var o=e("<div></div>",{"class":"deferred-loading-container",height:a.loadingHeight}),d=t.find(".bs-pagination");!a.loadingMinHeight||d&&d.hasClass("more_btn")||o.css("min-height",a.loadingMinHeight),o.append(r.getLoadingRawHtml()),o.appendTo(t)}r.id=t.attr("id");var l=r.getAjaxProps("deferred");"object"==typeof i[r.id]&&i[r.id].abort(),i[r.id]=e.ajax({url:l.ajax_url,type:"POST",dataType:"json",data:l}).done(function(e){t.find(".deferred-loading-container").remove(),delete i[r.id],t.addClass("deferred-html-exists").append(e.output),r.handler_slider(t),s&&s.call(t,e);var a=t.closest(".bs-pinning-block.pinned").length;n(!a),r.settings.afterSuccessDeferredAjax.call(r,t,e)})}})},t.prototype.getLoadingRawHtml=function(){return'<div class="bs-pagin-loading-wrapper">'+bs_pagination_loc.loading+"</div>"},t.prototype.getAjaxProps=function(e){e=e||"pagination";var n,t="deferred"===e?this.deferredPrefix:this.prefix,a=t+this.id;if("undefined"==typeof window[a])throw"pagination settings not set";switch(n=jQuery.parseJSON(window[a]),e.toLowerCase()){case"pagination":n.action="pagination_ajax",n.current_page=this.$link_el.parent().data("current-page")||1,n.pagin_type=this.paginationStyle;break;case"deferred":n.action="deferred_loading",n.current_page=1}return n},t.prototype.setNewPageNumber=function(){var e=this.$link_el.parent(),n=e.data("current-page")||1;if(this.isPrevPage=this.$link_el.hasClass("prev"),this.isPrevPage){if(2>n)throw"Wrong page number!";n--}else n++;e.data("current-page",n)},t.prototype.debug=function(e){console.error(e)},t.prototype.cacheThisStyle=function(e){return"next_prev"===e},t.prototype.getPaginationStyle=function(){for(var e,n=["next_prev","more_btn","more_btn_infinity","infinity"],t=this.$link_el.closest(".bs-pagination"),a=0;a<n.length;a++)if(e=n[a],t.hasClass(e))return e;return""},t.prototype.cache_get=function(e,n){return"undefined"!=typeof s[n]&&"undefined"!=typeof s[n][e]?s[n][e]:void 0},t.prototype.cache_add=function(e,n,t){"undefined"==typeof s[t]&&(s[t]={}),s[t][e]=n},t.prototype.handle_event=function(e,n){if("object"!=typeof e.events)return!1;if("string"==typeof e.events[n]){var t=e.events[n];"function"==typeof window[t]&&window[t].call(this,e,n)}},t.prototype.handle_response=function(t){if(null===t||"string"==typeof t.error)return void(null===t?this.debug("Error!"):this.debug(t.error));var a=this.$link_el.closest(".bs-pagination"),i=a.prevAll(".bs-pagination-wrapper"),s=a.closest(".bs-pinning-block.pinned").length;switch(this.handle_event(t,"before_append"),this.paginationStyle){case"next_prev":i.html(t.output),this.handle_event(t,"after_append"),i.addClass("bs-animate").addClass(this.isPrevPage?"bs-fadeInLeft":"bs-fadeInRight").delay(400).queue(function(n){e(this).removeClass("bs-animate bs-fadeInRight bs-fadeInLeft"),n()}),n(!s),"undefined"!=typeof t.label&&a.find(".bs-pagination-label").html(t.label),a.find(".next")[t.have_next?"removeClass":"addClass"]("disabled"),a.find(".prev")[t.have_prev?"removeClass":"addClass"]("disabled");break;case"more_btn":case"more_btn_infinity":case"infinity":if("string"==typeof t["add-to"]){var r=e(t.output);"prepend"==t["add-type"]?i.find(t["add-to"]).prepend(r):i.find(t["add-to"]).append(r)}else var r=i.append(t.output).children(":last");n(!s),this.handle_event(t,"after_append"),r.addClass("bs-animate bs-fadeInUp").delay(400).queue(function(n){e(this).removeClass("bs-animate bs-fadeInUp"),n()}),"infinity"===this.paginationStyle?t.have_next||this.$link_el.unbind("inview").remove():t.have_next?this.$link_el.removeClass("disabled"):(this.$link_el.addClass("disabled"),this.$link_el.find(".loaded").remove(),this.$link_el.find(".no-more").show())}this.refreshLazyImages(),this.handle_event(t,"after_response")},e.fn.Better_Ajax_Pagination=function(e){return new t(e).handler_slider(),this.each(function(){(new t).init(this)})},e.fn.Better_Deferred_Loading=function(e){var n=new t(e);return n.bindDeferredEvents(e.context),n}}(jQuery);