var Publisher_Theme_Admin=function(t){"use strict";return{init:function(){this.blocks_switch(),this.attach_events(),this.mailchimp(),this.custom_width_field(),this.set_up_vc_listing_settings_override()},mailchimp:function(){t(document).on("change",".widget-mailchimp-code-field textarea",function(i,e){var a=t(this).val().match(/action="([^"]*?)"/i);void 0!=a&&void 0!==a[1]&&t(this).closest(".widget-mailchimp-code-field").siblings(".widget-mailchimp-url-field").find("input").val(a[1])}),t(document).on("change",'.wpb_el_type_textarea_raw_html textarea[name="mailchimp-code"]',function(){var i=t(this).val().match(/action="([^"]*?)"/i);void 0!=i&&void 0!==i[1]&&t(this).closest(".wpb_el_type_textarea_raw_html").siblings('div[data-vc-shortcode-param-name="mailchimp-url"]').find('textarea[name="mailchimp-url"]').val(i[1])})},attach_events:function(){var i=this;t(document).on("bf-ajax-tab-loaded",function(t,e){i.blocks_switch(e)}),jQuery(document).ajaxSuccess(function(e,a,n){var l=t.unserialize(n.data);if("save-widget"==l.action){var s=l["widget-id"],c=t("input.widget-id[value='"+s+"']").closest(".widget");i.blocks_switch(c)}})},blocks_switch:function(i){t(".blocks-field .blocks-switch span, .blocks-field .title",i).on("click",function(){var i=t(this),e=i.closest(".blocks-field").find(".blocks-switch"),a=e.find("input"),n=e.closest(".bf-controls"),l=n.find('.blocks-field[data-related-to="'+i.closest(".blocks-field").data("id")+'"]');e.hasClass("checked")?(e.removeClass("checked").addClass("unchecked"),a.attr("value",0).change(),l.addClass("disabled")):(e.removeClass("unchecked").addClass("checked"),a.attr("value",1).change(),l.removeClass("disabled"))}),t(".blocks-field .blocks-checkbox-label",i).on("click",function(){var i=t(this),e=i.siblings(".blocks-checkbox");e.hasClass("checked")?(e.removeClass("checked").addClass("unchecked"),e.attr("value",0).change()):(e.removeClass("unchecked").addClass("checked"),e.attr("value",1).change())})},custom_width_field:function(){function i(t){return t.element.closest(".resizable-width-container")}function e(t){return t%2&&t++,t}function a(i){var e=0;return i.each(function(){e+=t(this).data("width-prc")}),e}function n(e){var a=[e.element,e.element.next(".resizable-width-column")],n=i(e),l=t(".resizable-width-column",n),s=l;return a.forEach(function(t){l=l.not(t)}),[l,s.not(l)]}function l(e,l){var s=i(l),c=n(l),o=t(".resizable-width-section",s).outerWidth(),r=c[1],d=100-a(c[0]);r.filter(":not(:last)").each(function(){var i=t(this),e=Math.ceil(100*i.outerWidth()/o);i.data("width-prc",e).find(".resizable-width-labels-percentage").text(e+"%"),t("input.col-"+i.data("index")+"-width",s).val(e),d-=e}),d=Math.abs(d);var h=r.filter(":last");h.data("width-prc",d).find(".resizable-width-labels-percentage").text(d+"%"),t("input.col-"+h.data("index")+"-width",s).val(d)}function s(e,l){var s=i(l),c=n(l),o=c[1],r=t("input.total-width",s).val(),h=r-Math.ceil(a(c[0])/100*r);o.length||(o=t(".resizable-width-column",s),h=r),o.filter(":not(:last)").each(function(i){var e=t(this),a=e.data("width-prc"),n=Math.ceil(a/100*r);e.data("width-px",n).find(".resizable-width-labels-px").text(n+"px"),n<=d.columnMinWidth&&e.resizable("option","minWidth",e.outerWidth()),h-=n}),o.filter(":last").data("width-px",h).find(".resizable-width-labels-px").text(h+"px")}function c(e){var a=[e.element,e.element.next(".resizable-width-column")],n=i(e),l=t(".resizable-width-column",n);a.forEach(function(t){l=l.not(t)}),l.each(function(){var i=t(this),e=i.outerWidth();i.outerWidth(e).css({"min-width":e,"max-width":e})}),a.forEach(function(t){t.attr("style","")})}function o(t){return t.data("columns")||2}function r(e){var a=i(e),n=t(".resizable-width-columns-wrapper",a),l=t("input.total-width",a).val(),s=Math.max(2,o(n)-1)*d.borderSpacing,c=n.width(),r=Math.floor(d.columnMinWidth*c/l);e.originalElement.resizable("option","minWidth",r);var h=e.originalElement.next(".resizable-width-column").width()+e.originalElement.width()+s,u=h-r;e.originalElement.resizable("option","maxWidth",u)}var d={columnMinWidth:150,wrapper2ColumnMinWidth:600,wrapper3ColumnMinWidth:1e3,wrapperMaxWidth:1640,transformPxRatio:10,borderSpacing:4};!function(){t(".resizable-width-column").each(function(){var i=t(this),e=i.data("width-prc");e&&i.outerWidth(e+"%")})}(),t(".resizable-width-columns").each(function(){t(".resizable-width-column:not(:last)",this).resizable({handles:"e",minHeight:250,maxHeight:250,stop:function(i,e){var a=0,n=[];t(".resizable-width-column",e.element.parent()).each(function(){var i=t(this),e=i.outerWidth();a+=e,n.push([i,e])}).promise().done(function(){a/=100;for(var t=0;t<n.length;t++){var i=n[t][0];i.width(n[t][1]/a+"%")}})},resize:function(t,i){l(t,i),s(t,i)},start:function(t,i){r(i),c(i)}})}),t(".resizable-width-container").each(function(){function a(t){return(t-h)/(d.transformPxRatio/2)+r}var n=t(this),l=n.find(".resizable-width-columns-wrapper"),c=o(l),r=(2==c?44:70)*c,h=2==c?d.wrapper2ColumnMinWidth:d.wrapper3ColumnMinWidth,u=a(d.wrapperMaxWidth),m=a(l.data("total"));t(".resizable-width-total-wrapper",n).width(m),l.width(m),l.resizable({minHeight:280,maxHeight:280,handles:"e,w",minWidth:r,maxWidth:u,resize:function(a,n){if(!(n.size.width%2)){var l=i(n),c=h+(n.size.width-r)/2*d.transformPxRatio;c=e(c),t(".resizable-width-total-wrapper",l).outerWidth(n.size.width).css("left",n.position.left),t(".resizable-width-total-number",l).text(Math.ceil(c)+"px"),t("input.total-width",l).val(c),s(a,n)}},start:function(e,a){a.element.find(".resizable-width-column").css({"min-width":"","max-width":""});var n=i(a);t(".resizable-width-column",n).each(function(){var i=t(this),e=i.find(".resizable-width-labels-percentage").text();i.outerWidth(e)})}}).data("resize-options",{maxWidth:u})})},set_up_vc_listing_settings_override:function(){var i=this;t(document).on("change",".wpb_edit_form_elements .advanced-block-settings :input",function(){var i=t(this),e=t(".wpb_edit_form_elements"),a=t("input[name='override-listing-settings']",e).val(),n=t("input[name='listing-settings']",e),l="";"0"!==a&&(l=i.closest(".advanced-block-settings").bf_serialize()),0===n.length?t("<input/>",{name:"listing-settings",class:"wpb_vc_param_value",value:l,type:"hidden"}).appendTo(e):n.val(l)}),t(document).on("change",'.wpb_edit_form_elements input[name="override-listing-settings"]',function(){"0"===this.value&&t(".wpb_edit_form_elements input[name='listing-settings']").remove()}),t(document).ajaxSuccess(function(e,a,n){var l=t.unserialize(n.data);if("vc_edit_form"===l.action){var s=t(".wpb_edit_form_elements");i.blocks_switch(s),t(".blocks-field :input:first",s).trigger("change")}})}}}(jQuery);jQuery(document).ready(function(){Publisher_Theme_Admin.init()});